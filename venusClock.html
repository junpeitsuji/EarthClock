<!DOCTYPE html>
<html lang="ja">
<head>
	<meta charset="UTF-8">
		<title>金星時計</title>

	<link rel="stylesheet" type="text/css" href="css/clock.css">

	<script src="three.min.js"></script>
	<script src="js/Detector.js"></script>
	<script src="js/controls/OrbitControls.js"></script>
	<script>

		function threeStart(domId) {
			if(!Detector.webgl) Detector.addGetWebGLMessage();

			var glframe = document.getElementById(domId);

			var width = glframe.clientWidth;
			var height = glframe.clientHeight;  

			var renderer;
			renderer = new THREE.WebGLRenderer({ antialias:true });
			renderer.setSize(width, height);
			renderer.setClearColorHex(0x000000, 1);
			glframe.appendChild(renderer.domElement);

			var scene;
			scene = new THREE.Scene();

			var camera;
			camera = new THREE.PerspectiveCamera(
				15, width / height);
			camera.position = new THREE.Vector3(0, 0, 8);
			camera.lookAt(new THREE.Vector3(0, 0, 0));
			scene.add(camera);

			var light;
			light = new THREE.DirectionalLight(0xcccccc);
			//light.position = new THREE.Vector3(0.577, 0.577, 0.577);
			light.position = new THREE.Vector3(0, 0, 100);
			//var ambient = new THREE.AmbientLight(0x333333);
			scene.add(light);
			//scene.add(ambient);

// /*
			var geometry = new THREE.SphereGeometry(1, 32, 16);
			var material = new THREE.MeshPhongMaterial({
				color: 0xffffff, specular: 0xcccccc, shininess:50, ambient: 0xffffff,
				map: THREE.ImageUtils.loadTexture('images/VenusMap.jpg') });
			var mesh = new THREE.Mesh(geometry, material);
			scene.add(mesh);
// */
			// カメラコントロールを作成
			var controls
			controls = new THREE.OrbitControls(camera, glframe);
			controls.center = new THREE.Vector3(0, 0, 0);

			var baseTime = +new Date(2012, 1, 1, 0, 0, 0);
			function render() {
				requestAnimationFrame(render);

				// カメラの状態を更新
				controls.update();

				var date = new Date();

				//mesh.rotation.y = 0.3 * (+date - baseTime) / 1000;
				var theta = (+date - baseTime) * 2.0*Math.PI / (60*1000);
				mesh.rotation.y = theta;
				//cube.rotation.y = (+date - baseTime) * 2.0*3.14159265 / (60*1000);

				var str  = '<h1>'+date+'</h1>';

				document.getElementById('clock').innerHTML = str;
				renderer.clear();  
				renderer.render(scene, camera);
				
			};
			render();

			glframe.addEventListener('resize', function() {
				renderer.setSize(width, height);
				camera.aspect = width / height;
				camera.updateProjectionMatrix();
			}, false );
		}
	</script>
</head>
<body style="margin:0; overflow:hidden;" onload="threeStart('canvas-frame');">

<div id="header">
	<h1>金星時計</h1>
	<p>一分に一回転する金星儀です。マウスクリックやホイールで視点の位置を変えられます。（ブラウザはChrome推奨。）</p>
</div>
<div id="clock"></div>
<div id="canvas-frame"></div>

<div id="footer">
	<p>参考WebサイトURL：Webグラフィックをハックする（5）多彩な表現力のWebGLを扱いやすくする「Three.js」,  
		<a href="http://www.atmarkit.co.jp/fwcr/design/benkyo/webgraphics05/01.html">http://www.atmarkit.co.jp/fwcr/design/benkyo/webgraphics05/01.html</a>
	</p>
	<p>テクスチャ画像素材: Tom Patterson, <a href="http://www.shadedrelief.com">www.shadedrelief.com</a></p>
	<p>制作: Junpei Tsuji (twitter: <a href="https://twitter.com/tsujimotter">@tsujimotter</a>)</p>
</div>
</body>
</html>
